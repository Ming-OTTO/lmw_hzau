# 图像拼接L版使用说明

## 📋 功能说明

**修改内容**：将拼接结果的命名方式从固定的`merged.png`改为使用**父文件夹名称**作为文件名。

## 🔄 修改前后对比

| 修改前 | 修改后 |
|--------|--------|
| `merged.png` | `父文件夹名称.png` |
| 所有结果都叫merged.png | 每个结果都有唯一名称 |

## 📁 文件结构示例

### 原始目录结构
```
G:\2025cotton\
├── sample001\
│   ├── img1.jpg
│   └── img2.jpg
├── sample002\
│   ├── img1.jpg
│   └── img2.jpg
└── sample003\
    ├── img1.jpg
    └── img2.jpg
```

### 输出目录结构（修改后）
```
G:\out_img_pinjie\
├── sample001\
│   └── sample001.png
├── sample002\
│   └── sample002.png
└── sample003\
    └── sample003.png
```

## 🚀 使用方法

### 1. 激活环境
```bash
# 双击运行 activate_env.bat
# 或手动激活：
conda activate lmw_python_project
```

### 2. 修改路径参数
编辑文件中的路径：
```python
path_img = r'G:\2025cotton'      # 你的原始数据目录
path_save = r'G:\out_img_pinjie'  # 你的输出目录
```

### 3. 运行脚本
```bash
python 图像拼接L版.py
```

## ⚙️ 代码修改详情

### 关键修改点
```python
# 获取父文件夹名称作为文件名
parent_folder_name = os.path.basename(root)
save_filename = f"{parent_folder_name}.png"

# 输出文件完整路径
save_path = os.path.join(out_dir, save_filename)
```

### 函数说明
- `os.path.basename(root)`：获取当前文件夹名称
- `f"{parent_folder_name}.png"`：拼接文件名
- 保持原有的目录结构不变

## 🧪 测试验证

运行测试脚本验证功能：
```bash
python test_pinjie.py
```

测试内容包括：
- ✅ 文件名生成功能
- ✅ 目录结构保持
- ✅ 图像拼接逻辑

## 📝 注意事项

1. **文件夹命名**：确保文件夹名称符合文件系统命名规范
2. **文件覆盖**：如果目标文件已存在，会自动跳过
3. **权限问题**：确保有读写目标目录的权限
4. **图像格式**：输入图像应为JPG格式，输出为PNG格式

## 🔍 故障排除

### 常见问题
1. **找不到文件**：检查输入目录路径是否正确
2. **权限错误**：以管理员身份运行或检查目录权限
3. **图像读取失败**：确认图像文件是否完整

### 调试信息
运行时会输出每个处理步骤的信息：
```
已保存: G:\out_img_pinjie\sample001\sample001.png
已保存: G:\out_img_pinjie\sample002\sample002.png
```